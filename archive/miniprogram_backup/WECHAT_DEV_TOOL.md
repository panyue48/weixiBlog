# 微信开发者工具使用指南

## 一、下载和安装微信开发者工具

### 1. 下载
访问微信官方下载页面：
- 官网：https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
- 或直接搜索"微信开发者工具"下载

### 2. 安装
- Windows: 运行下载的 `.exe` 安装程序
- Mac: 运行下载的 `.dmg` 安装程序
- 按照安装向导完成安装

## 二、准备工作

### 1. 确保后端服务已启动
```bash
# 在项目根目录
mvn spring-boot:run
# 或使用IDE运行 BlogApplication.java
```
后端服务应运行在：http://localhost:8083/api

### 2. 编译前端项目
```bash
cd miniprogram
npm install
npm install uview-ui@2.0.36
npm run dev:mp-weixin
```

编译完成后，会在 `miniprogram/dist/dev/mp-weixin` 目录生成小程序代码。

## 三、在微信开发者工具中打开项目

### 步骤1：打开微信开发者工具
1. 启动微信开发者工具
2. 使用微信扫码登录（首次使用需要）

### 步骤2：创建/导入项目
1. 点击左上角 **"+"** 或 **"项目"** → **"新建项目"**
2. 填写项目信息：
   - **项目名称**：`weixi-blog`（任意名称）
   - **目录**：选择 `miniprogram/dist/dev/mp-weixin` 目录
     ```
     例如：C:\cursorworkplace\weixiBlog\miniprogram\dist\dev\mp-weixin
     ```
   - **AppID**：
     - **测试号**：选择"测试号"（推荐用于开发测试）
     - **正式号**：如果有小程序AppID，填写你的AppID
   - **开发模式**：选择"小程序"
3. 点击 **"确定"** 或 **"新建"**

### 步骤3：等待编译
- 工具会自动编译项目
- 首次编译可能需要几分钟
- 编译完成后会在右侧显示预览界面

## 四、配置和调试

### 1. 配置后端地址（如需要）
如果后端地址不是 `http://localhost:8083/api`，需要修改：

1. 在微信开发者工具中，点击左侧 **"详情"** 标签
2. 找到 **"本地设置"**
3. 勾选 **"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"**
   - ⚠️ 这个选项仅在开发环境使用，生产环境需要配置合法域名

或者修改代码：
- 打开 `miniprogram/utils/request.js`
- 修改 `BASE_URL` 为你的后端地址

### 2. 查看控制台
- 点击底部 **"控制台"** 标签查看日志
- 查看 **"Network"** 标签查看网络请求
- 查看 **"调试器"** 标签进行代码调试

### 3. 预览功能
- **编译**：修改代码后，工具会自动编译，或点击 **"编译"** 按钮
- **预览**：点击工具栏的 **"预览"** 按钮，生成二维码，用微信扫码在手机上预览
- **真机调试**：点击 **"真机调试"** 按钮，可以在手机上调试

## 五、常见问题解决

### 问题1：编译失败
**错误信息**：`npm install` 相关错误

**解决方案**：
1. 在项目根目录执行：
   ```bash
   cd miniprogram
   npm install
   npm install uview-ui@2.0.36
   ```
2. 重新执行 `npm run dev:mp-weixin`
3. 重新在微信开发者工具中打开项目

### 问题2：网络请求失败
**错误信息**：`request:fail` 或 `域名不在合法列表中`

**解决方案**：
1. 点击 **"详情"** → **"本地设置"**
2. 勾选 **"不校验合法域名..."**
3. 重新编译项目

### 问题3：uView UI 组件不显示
**错误信息**：组件未找到或样式丢失

**解决方案**：
1. 确认已安装 uview-ui：
   ```bash
   cd miniprogram
   npm install uview-ui@2.0.36
   ```
2. 确认 `main.js` 中已引入：
   ```javascript
   import uView from 'uview-ui'
   app.use(uView)
   ```
3. 重新编译：`npm run dev:mp-weixin`

### 问题4：页面显示空白
**解决方案**：
1. 查看控制台错误信息
2. 检查后端服务是否启动
3. 检查网络请求是否成功
4. 尝试清除缓存：**"工具"** → **"清除缓存"** → **"清除全部"**

### 问题5：登录功能不可用
**原因**：需要真实的微信登录环境

**解决方案**：
1. 使用 **"预览"** 功能在手机上测试（真实微信环境）
2. 或在开发者工具中配置测试账号
3. 代码已包含模拟登录逻辑，但真实环境需要配置AppID和Secret

## 六、开发工作流

### 日常开发流程：

1. **修改代码**
   - 在 `miniprogram` 目录下修改 Vue 文件
   - 修改 `utils/request.js`、`api/index.js` 等

2. **重新编译**
   ```bash
   cd miniprogram
   npm run dev:mp-weixin
   ```

3. **刷新预览**
   - 微信开发者工具会自动检测文件变化
   - 或点击 **"编译"** 按钮手动刷新

4. **调试**
   - 使用控制台查看日志
   - 使用调试器设置断点
   - 使用 Network 查看API请求

5. **真机测试**
   - 点击 **"预览"** 生成二维码
   - 用微信扫码在手机上测试

## 七、重要提示

### ⚠️ 开发环境配置
- **本地设置**中必须勾选 **"不校验合法域名"**，否则无法访问本地后端
- 生产环境部署前，需要在微信公众平台配置服务器域名

### ⚠️ AppID 说明
- **测试号**：可以正常开发，但部分功能受限
- **正式号**：需要注册小程序，获得AppID后才能使用完整功能
- **登录功能**：需要配置真实的AppID和Secret才能使用

### ⚠️ 端口占用
- 确保后端服务运行在 8083 端口
- 如果端口被占用，修改 `application.yml` 中的端口配置

## 八、快速检查清单

在微信开发者工具中打开项目前，确保：

- [ ] 已安装 Node.js 和 npm
- [ ] 已执行 `npm install` 和 `npm install uview-ui@2.0.36`
- [ ] 已执行 `npm run dev:mp-weixin` 生成小程序代码
- [ ] 后端服务已启动（http://localhost:8083/api）
- [ ] 在微信开发者工具中选择了正确的目录（`dist/dev/mp-weixin`）
- [ ] 已勾选"不校验合法域名"选项

## 九、下一步

完成以上步骤后，你应该能够：
- ✅ 在微信开发者工具中看到项目预览
- ✅ 点击页面进行交互
- ✅ 查看控制台日志
- ✅ 测试登录、发布、浏览等功能
- ✅ 使用预览功能在手机上测试

如果遇到问题，请查看控制台的错误信息，或参考本文档的"常见问题解决"部分。

